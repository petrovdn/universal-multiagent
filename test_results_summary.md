# Результаты тестирования интеграций

## Дата тестирования
2025-12-23

## Статус интеграций

### ✅ Gmail - РАБОТАЕТ
- **Статус**: Подключено
- **Инструментов**: 19
- **Доступные инструменты**:
  - send_email
  - draft_email
  - read_email
  - search_emails
  - delete_email
  - modify_email
  - batch_delete_emails
  - batch_modify_emails
  - list_email_labels
  - create_label
  - update_label
  - delete_label
  - get_or_create_label
  - create_filter
  - create_filter_from_template
  - get_filter
  - delete_filter
  - list_filters
  - download_attachment

**Примечание**: Инструмент `send_email` ожидает массив для поля `to`, а не строку. Формат: `{"to": ["email@example.com"], "subject": "...", "body": "..."}`

### ❌ Calendar - НЕ РАБОТАЕТ
- **Статус**: Подключено, но инструменты не обнаружены (0 инструментов)
- **Проблема**: Интеграция не авторизована через OAuth
- **Ошибка**: Инструменты не обнаружены, возможно, токен отсутствует или недействителен

**Решение**: 
1. Проверьте наличие токена в `config/google_calendar_token.json`
2. Включите интеграцию через веб-интерфейс: `/api/integrations/google-calendar/enable`
3. Завершите OAuth авторизацию
4. Убедитесь, что MCP сервер Calendar запускается корректно

### ❌ Sheets - НЕ РАБОТАЕТ
- **Статус**: Подключено, но инструменты не обнаружены (0 инструментов)
- **Проблема**: Интеграция не авторизована через OAuth
- **Ошибка**: Инструменты не обнаружены, возможно, токен отсутствует или недействителен

**Решение**:
1. Проверьте наличие токена в `config/google_sheets_token.json`
2. Включите интеграцию через веб-интерфейс: `/api/integrations/google-sheets/enable`
3. Завершите OAuth авторизацию
4. Убедитесь, что MCP сервер Sheets запускается корректно

## Проблемы

### 1. Calendar и Sheets OAuth авторизация
Проект использует собственные MCP серверы для Calendar и Sheets. Инструменты не обнаруживаются, если интеграции не авторизованы через OAuth.

**Возможные решения**:
1. Убедитесь, что OAuth credentials настроены в `config/.env`
2. Включите интеграции через веб-интерфейс приложения
3. Завершите OAuth процесс для каждой интеграции
4. Проверьте, что токены сохранены в соответствующих файлах

### 2. Gmail send_email формат
Инструмент `send_email` ожидает массив для поля `to`, а не строку. Нужно обновить код в `gmail_tools.py` или проверить правильный формат аргументов.

## Рекомендации

1. **Для Gmail**: Исправить формат аргументов в `gmail_tools.py` - использовать массив для `to`
2. **Для Calendar/Sheets**: 
   - Авторизовать интеграции через OAuth в веб-интерфейсе приложения
   - Убедиться, что токены сохранены корректно
   - Проверить, что MCP серверы запускаются автоматически

## Следующие шаги

1. Исправить формат аргументов для Gmail send_email (если еще не исправлено)
2. Авторизовать интеграции Calendar и Sheets через OAuth
3. Протестировать создание встречи после авторизации
4. Протестировать отправку email после исправления формата



